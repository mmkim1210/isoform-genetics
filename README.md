# isoform-genetics

This repository contains code and instructions for heritability and genetic correlation analyses, using the [MultiResponseVarianceComponentModels.jl](https://github.com/Hua-Zhou/MultiResponseVarianceComponentModels.jl) <a href="https://julialang.org"><img src="https://julialang.org/assets/infra/julia.ico" width="10em"> Julia </a>package and applying it to the [PsychENCODE brain gene and isoform expression data](http://resource.psychencode.org/). There is a great number of primary literature, review papers, and educational materials that explain in broad strokes the heuristics of heritability and genetic correlation analyses. If you are interested more in technical details with clarity of presentation and mathematical notation, please take a look at the **Methods** section of the associated paper [Kim et al. 2022](#references). All analyses herein were conducted solely using <a href="https://julialang.org"><img src="https://julialang.org/assets/infra/julia.ico" width="10em"> Julia</a>. If you have any questions, also let me know via my email minsookim@mednet.ucla.edu.

## Getting started
[To install necessary packages and activate a separate environment](https://pkgdocs.julialang.org/v1/environments/#Using-someone-else's-project), open <a href="https://julialang.org"><img src="https://julialang.org/assets/infra/julia.ico" width="10em"> Julia</a> within the directory and type:
```julia
julia> ]
(@v1.9) pkg> activate .
(isoform-genetics) pkg> instantiate
```
## Required data
    data
    ├── expression
    │   ├── PsychENCODE-EUR-gene.BED.gz                                                 # normalized PsychENCODE gene expression
    │   ├── PsychENCODE-EUR-isoform.BED.gz                                              # normalized PsychENCODE isoform expression
    │   └── PsychENCODE-EUR-covariates.tsv                                              # covariates for mean (or fixed) effects
    ├── genotype
    │   └── Capstone4.HRC.European.unique.frontal.nochr.filter.unrelated.{bed,bim,fam}  # PsychENCODE genotype data
    ├── 1kg
    │   └── kgp.eur.maf0.05.{bed,bim,fam}                                               # 1000 Genomes data subsetted to European individuals
    └── gwas                                                                            # GWAS summary statistics

## Figures
Once the result has been parsed, Figures 1-5 in [Kim et al. 2022](#references) can be generated by running `./src/fig{1,2,3,4,5}.jl`, respectively. Such figures can then be edited slightly using `Illustrator` to finalize figures as follows.

**Figure 1:**
<p align="center"><img width="100%" style="border-radius: 5px;" src="assets/fig1.png"></p>

**Figure 2:**
<p align="center"><img width="100%" style="border-radius: 5px;" src="assets/fig2.png"></p>

**Figure 3:**
<p align="center"><img width="100%" style="border-radius: 5px;" src="assets/fig3.png"></p>

**Figure 4:**
<p align="center"><img width="100%" style="border-radius: 5px;" src="assets/fig4.png"></p>

**Figure 5:**
<p align="center"><img width="100%" style="border-radius: 5px;" src="assets/fig5.png"></p>

<a name="references"/>

## References
- M. Kim, D.D. Vo, C.T. Jops, C. Wen, A. Patowary, A. Bhattacharya, C.X. Yap, H. Zhou, and M.J. Gandal: **Multivariate variance components analysis uncovers genetic architecture of brain isoform expression and novel psychiatric disease mechanisms** (2022) ([link](https://www.medrxiv.org/content/10.1101/2022.10.18.22281204v1))